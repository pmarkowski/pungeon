(this["webpackJsonppungeon-react"]=this["webpackJsonppungeon-react"]||[]).push([[0],{26:function(e,t,a){e.exports=a(49)},31:function(e,t,a){},49:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(7),i=a.n(c),o=(a(31),a(20)),l=a(21),s=a(25),d=a(24),u=a(5),b=a(9),h=a(15),m=a(1),E=function(e,t,a){return e.map((function(e){if(e.id===t){var n=Object(m.a)({},e);return a(n),n}return e}))},p=function(e){return{type:"SELECT_TOOL",selectedTool:e}},f=function(e){return{type:"SELECT_OBJECT",objectId:e}},y=function(e,t){return{type:"MOVE_SELECTED_OBJECT",deltaX:e,deltaY:t}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOUSE_DOWN":return Object(m.a)(Object(m.a)({},e),{},{mouseDown:!0,mouseStartX:t.x,mouseStartY:t.y});case"MOUSE_UP":return Object(m.a)(Object(m.a)({},e),{},{mouseDown:!1});case"SET_DUNGEON_SIZE":return Object(m.a)(Object(m.a)({},e),{},{dungeon:Object(m.a)(Object(m.a)({},e.dungeon),{},{size:{width:t.width,height:t.height}})});case"SET_SCROLL_MOVES_VIEWPORT":return Object(m.a)(Object(m.a)({},e),{},{scrollMovesViewport:t.scrollMovesViewport});case"MOVE_SELECTED_OBJECT":var a=E(e.dungeon.spaces,e.selectedObject,(function(e){return e.position={x:e.position.x+t.deltaX,y:e.position.y+t.deltaY}}));return Object(m.a)(Object(m.a)({},e),{},{dungeon:Object(m.a)(Object(m.a)({},e.dungeon),{},{spaces:a})});case"SET_SELECTED_OBJECT_POSITION":var n=E(e.dungeon.spaces,e.selectedObject,(function(e){return e.position={x:t.x,y:t.y}}));return Object(m.a)(Object(m.a)({},e),{},{dungeon:Object(m.a)(Object(m.a)({},e.dungeon),{},{spaces:n})});case"SET_SELECTED_OBJECT_SIZE":var r=E(e.dungeon.spaces,e.selectedObject,(function(e){return e.size={width:t.width,height:t.height}}));return Object(m.a)(Object(m.a)({},e),{},{dungeon:Object(m.a)(Object(m.a)({},e.dungeon),{},{spaces:r})});case"SET_SELECTED_OBJECT_START":var c=E(e.dungeon.walls,e.selectedObject,(function(e){return e.start={x:t.x,y:t.y}}));return Object(m.a)(Object(m.a)({},e),{},{dungeon:Object(m.a)(Object(m.a)({},e.dungeon),{},{walls:c})});case"SET_SELECTED_OBJECT_END":var i=E(e.dungeon.walls,e.selectedObject,(function(e){return e.end={x:t.x,y:t.y}}));return Object(m.a)(Object(m.a)({},e),{},{dungeon:Object(m.a)(Object(m.a)({},e.dungeon),{},{walls:i})});case"ADD_SPACE":var o=e.dungeon.spaces.slice();return o=[].concat(Object(h.a)(o),[t.newSpace]),Object(m.a)(Object(m.a)({},e),{},{dungeon:Object(m.a)(Object(m.a)({},e.dungeon),{},{spaces:o})});case"ADD_WALL":var l=e.dungeon.walls.slice();return l=[].concat(Object(h.a)(l),[t.newWall]),Object(m.a)(Object(m.a)({},e),{},{dungeon:Object(m.a)(Object(m.a)({},e.dungeon),{},{walls:l})});case"SELECT_TOOL":var s=e.selectedObject;return"Select"!==t.selectedTool&&(s=null),Object(m.a)(Object(m.a)({},e),{},{selectedTool:t.selectedTool,selectedObject:s});case"SELECT_OBJECT":return"Select"===e.selectedTool?Object(m.a)(Object(m.a)({},e),{},{selectedObject:t.objectId}):e;case"DELETE_OBJECT":var d=e.selectedObject;if(d){var u=e.dungeon.spaces.filter((function(e){return e.id!==d})),b=e.dungeon.walls.filter((function(e){return e.id!==d}));return Object(m.a)(Object(m.a)({},e),{},{selectedObject:null,dungeon:Object(m.a)(Object(m.a)({},e.dungeon),{},{spaces:u,walls:b})})}return e;default:return e}},v=Object(b.b)(g,{scrollMovesViewport:!1,mouseDown:!1,mouseStartX:0,mouseStartY:0,selectedTool:"NewSpace",dungeon:{size:{width:28,height:32},spaces:[{id:"01f998f7-3ad4-43c6-b498-3249ab470b05",position:{x:1,y:1},size:{width:5,height:5}},{id:"79178d8c-3a3e-42ee-b1ec-00dc37a045fc",position:{x:6,y:4},size:{width:7,height:9}},{id:"6ce25fdc-9fd4-46c0-a924-74f5f9174193",position:{x:15,y:15},size:{width:6,height:7}},{id:"e211fbd3-a817-47a5-bb47-481ba330e46d",position:{x:21,y:19},size:{width:4,height:9}}],walls:[{id:"4abe3330-4a95-4c29-b71d-8ea768da1ee6",start:{x:1,y:1},end:{x:1,y:6}},{id:"ad3c6f9b-f3f0-4025-8073-daacc68483ec",start:{x:6,y:6},end:{x:1,y:6}},{id:"68365136-d12f-4e54-8f7b-4cbd3ab424eb",start:{x:6,y:13},end:{x:6,y:6}},{id:"3d6435e5-8d67-4405-87d0-72c4e8f4dfaa",start:{x:13,y:13},end:{x:6,y:13}},{id:"384ac23d-f5fc-4cd1-9ad7-b528b62fa732",start:{x:13,y:4},end:{x:13,y:13}},{id:"161e3147-ca11-4dc4-a26b-ca8295c5abaa",start:{x:6,y:4},end:{x:13,y:4}},{id:"e8092d63-e7e2-4cd2-8c80-8cd6030980f1",start:{x:6,y:1},end:{x:6,y:4}},{id:"71ed94d3-177b-428b-a8e5-fe25eb79a4ea",start:{x:1,y:1},end:{x:6,y:1}},{id:"0ea47a6f-af9f-4ec6-a7f3-881332643e2a",start:{x:15,y:15},end:{x:15,y:22}},{id:"f7ec5579-7966-4ba4-b8ee-fdaad6372842",start:{x:21,y:22},end:{x:15,y:22}},{id:"1e587060-37cc-4b87-a88a-852c8055cabb",start:{x:21,y:15},end:{x:15,y:15}},{id:"79e1f702-6d60-435b-ba1e-584077a7d479",start:{x:21,y:19},end:{x:21,y:15}},{id:"231997d1-1453-4573-a2c0-0571428d7ac9",start:{x:25,y:19},end:{x:21,y:19}},{id:"85033454-8145-4d36-9b58-5e891f731f25",start:{x:21,y:22},end:{x:21,y:28}},{id:"2c6b4f88-4163-4847-ba05-c4ce865dfd87",start:{x:21,y:28},end:{x:25,y:28}},{id:"57013c9b-609f-4e59-ae1a-fd94a49bac80",start:{x:25,y:19},end:{x:25,y:28}}]}},"undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),O=a(13),w=function(e,t){switch(e.key){case"Delete":return t.dispatch({type:"DELETE_OBJECT"});case"ArrowLeft":return t.dispatch(y(-1,0));case"ArrowRight":return t.dispatch(y(1,0));case"ArrowDown":return t.dispatch(y(0,1));case"ArrowUp":return t.dispatch(y(0,-1));default:return}},x=function(e){Object(s.a)(a,e);var t=Object(d.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{height:"85vh"},tabIndex:-1,ref:function(t){return e.canvasDiv=t}})}},{key:"componentDidMount",value:function(){var e=this,t=new u.a({backgroundColor:6250335,sharedLoader:!0,sharedTicker:!0,antialias:!0});this.app=t,this.canvasDiv.appendChild(t.view),this.app.resizeTo=this.canvasDiv,this.app.resize();var a=new u.b;a.zIndex=Number.MAX_SAFE_INTEGER,t.stage.sortableChildren=!0,t.stage.addChild(a);this.setupInteractions(t,70),t.ticker.add((function(n){var r=v.getState();a.clear(),e.drawSpaces(t.stage,r,70),e.drawGrid(a,r.dungeon.size.width,r.dungeon.size.height,70),t.renderer.plugins.interaction.mouseOverRenderer&&e.drawSelectedGridBox(t,r,70,a)}))}},{key:"setupInteractions",value:function(e,t){var a=this;this.canvasDiv.addEventListener("wheel",(function(t){if(!v.getState().scrollMovesViewport||t.getModifierState("Control")){var a=.1;t.wheelDeltaY<0&&(a*=-1);var n=Math.min(Math.max(e.stage.scale.x+a,.1),2);if(n!==e.stage.scale.x){e.stage.scale.set(n);var r=e.renderer.plugins.interaction.mouse.getLocalPosition(e.stage);e.stage.position.x-=r.x*a,e.stage.position.y-=r.y*a}}else{e.stage.position.x+=.5*t.wheelDeltaX,e.stage.position.y+=.5*t.wheelDeltaY}t.preventDefault()})),this.canvasDiv.addEventListener("contextmenu",(function(e){e.preventDefault()})),this.canvasDiv.addEventListener("pointerdown",(function(){a.onMouseDown(e)})),this.canvasDiv.addEventListener("pointerup",(function(){a.onMouseUp(e,t)})),this.canvasDiv.addEventListener("pointermove",(function(t){2===t.buttons&&(e.stage.position.x+=t.movementX,e.stage.position.y+=t.movementY)})),this.canvasDiv.addEventListener("keydown",(function(e){w(e,v)}))}},{key:"onMouseDown",value:function(e){if(0===e.renderer.plugins.interaction.mouse.button){var t=e.renderer.plugins.interaction.mouse.getLocalPosition(e.stage);v.dispatch({type:"MOUSE_DOWN",x:t.x,y:t.y})}}},{key:"onMouseUp",value:function(e,t){if(0===e.renderer.plugins.interaction.mouse.button){var a=e.renderer.plugins.interaction.mouse.getLocalPosition(e.stage);v.dispatch({type:"MOUSE_UP"});var n=v.getState();if("NewSpace"===n.selectedTool){var r=Math.floor(Math.min(n.mouseStartX,a.x)/t),c=Math.floor(Math.min(n.mouseStartY,a.y)/t),i=Math.ceil(Math.max(n.mouseStartX,a.x)/t),o=Math.ceil(Math.max(n.mouseStartY,a.y)/t);v.dispatch({type:"ADD_SPACE",newSpace:{id:Object(O.v4)(),position:{x:r,y:c},size:{width:i-r,height:o-c}}})}else if("NewWall"===n.selectedTool){var l=Math.round(n.mouseStartX/t),s=Math.round(n.mouseStartY/t),d=Math.round(a.x/t),u=Math.round(a.y/t);v.dispatch({type:"ADD_WALL",newWall:{id:Object(O.v4)(),start:{x:l,y:s},end:{x:d,y:u}}})}}}},{key:"drawSpaces",value:function(e,t,a){var n=t.dungeon.spaces.reduce((function(e,t){return e[t.id]=t,e}),{}),r=new Set(e.children.map((function(e){return e.id})));Object.keys(n).forEach((function(t){if(!r.has(t)){var a=new u.b;a.id=t,a.interactive=!0,a.mouseup=function(){v.dispatch(f(this.id))},e.addChild(a)}}));var c=t.dungeon.walls.reduce((function(e,t){return e[t.id]=t,e}),{});Object.keys(c).forEach((function(t){if(!r.has(t)){var a=new u.b;a.id=t,a.interactive=!0,a.mouseup=function(){v.dispatch(f(this.id))},e.addChild(a)}})),e.children.forEach((function(r){if(r.id){var i=n[r.id],o=c[r.id];if(i)r.clear(),r.beginFill(14079445),r.drawRect(i.position.x*a,i.position.y*a,i.size.width*a,i.size.height*a),r.endFill(),t.selectedObject===r.id?r.tint=16777164:r.tint=16777215;else if(o){r.clear(),r.beginFill(157414,1),r.lineStyle(10,157414,1,.5),r.moveTo(o.start.x*a,o.start.y*a),r.lineTo(o.end.x*a,o.end.y*a),r.lineStyle(),r.drawCircle(o.start.x*a,o.start.y*a,5),r.drawCircle(o.end.x*a,o.end.y*a,5);r.endFill(),t.selectedObject===r.id?r.tint=16777011:r.tint=16777215,r.hitArea=new u.c([o.start.x*a-5,o.start.y*a-5,o.start.x*a+5,o.start.y*a+5,o.end.x*a+5,o.end.y*a+5,o.end.x*a-5,o.end.y*a-5])}else e.removeChild(r)}}))}},{key:"drawSelectedGridBox",value:function(e,t,a,n){var r,c,i,o,l=e.renderer.plugins.interaction.mouse.getLocalPosition(e.stage);if("NewWall"!==t.selectedTool){if(t.mouseDown){var s=Math.min(t.mouseStartX,l.x),d=Math.min(t.mouseStartY,l.y),u=Math.max(t.mouseStartX,l.x),b=Math.max(t.mouseStartY,l.y);r=Math.floor(s/a)*a,c=Math.floor(d/a)*a,i=(u=Math.floor(u/a)*a+a)-r,o=(b=Math.floor(b/a)*a+a)-c}else r=Math.floor(l.x/a)*a,c=Math.floor(l.y/a)*a,i=a,o=a;n.beginFill(0,0),n.lineStyle(1,16776448),n.drawRect(r,c,i,o),n.endFill()}else if(t.mouseDown){var h=Math.round(t.mouseStartX/a)*a,m=Math.round(t.mouseStartY/a)*a,E=Math.round(l.x/a)*a,p=Math.round(l.y/a)*a;n.lineStyle(5,16776448),n.moveTo(h,m),n.lineTo(E,p),n.lineStyle(),n.beginFill(16776448),n.drawCircle(h,m,2.5),n.drawCircle(E,p,2.5),n.endFill()}else{var f=Math.round(l.x/a)*a,y=Math.round(l.y/a)*a;n.lineStyle(),n.beginFill(16776448),n.drawCircle(f,y,2.5),n.endFill()}}},{key:"drawGrid",value:function(e,t,a,n){e.lineStyle(1,4473924,1,.5);for(var r=0;r<t;r++)e.moveTo(r*n,0),e.lineTo(r*n,(a-1)*n);for(var c=0;c<a;c++)e.moveTo(0,c*n),e.lineTo((t-1)*n,c*n)}}]),a}(r.a.Component),S=a(4),j=function(e){var t=e.title,a=e.x,n=e.y,c=e.onUpdate;return r.a.createElement("div",{className:"card bg-dark text-light border-secondary mb-3"},r.a.createElement("div",{className:"card-header border-secondary"},r.a.createElement("h5",null," ",t||"Position")),r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"X:",r.a.createElement("input",{className:"form-control bg-secondary text-light",type:"number",value:a,onChange:function(e){return c(parseInt(e.target.value),n)}})),r.a.createElement("label",null,"Y:",r.a.createElement("input",{className:"form-control bg-secondary text-light",type:"number",value:n,onChange:function(e){return c(a,parseInt(e.target.value))}})))))},T=function(e){var t=e.title,a=e.width,n=e.height,c=e.onUpdate;return r.a.createElement("div",{className:"card bg-dark text-light border-secondary mb-3"},r.a.createElement("div",{className:"card-header border-secondary"},r.a.createElement("h5",null," ",t||"Size")),r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Width:",r.a.createElement("input",{className:"form-control bg-secondary text-light",type:"number",value:a,onChange:function(e){return c(parseInt(e.target.value),n)}})),r.a.createElement("label",null,"Height:",r.a.createElement("input",{className:"form-control bg-secondary text-light",type:"number",value:n,onChange:function(e){return c(a,parseInt(e.target.value))}})))))},_=function(e){var t=e.dispatch,a=e.selectedObjectId,n=e.selectedObject,c=e.dungeonSize,i=e.scrollPansViewport;return a?r.a.createElement(r.a.Fragment,null,n.position&&r.a.createElement(j,{x:n.position.x,y:n.position.y,onUpdate:function(e,a){return t(function(e,t){return{type:"SET_SELECTED_OBJECT_POSITION",x:e,y:t}}(e,a))}}),n.size&&r.a.createElement(T,{width:n.size.width,height:n.size.height,onUpdate:function(e,a){return t(function(e,t){return{type:"SET_SELECTED_OBJECT_SIZE",width:e,height:t}}(e,a))}}),n.start&&r.a.createElement(j,{title:"Start",x:n.start.x,y:n.start.y,onUpdate:function(e,a){return t(function(e,t){return{type:"SET_SELECTED_OBJECT_START",x:e,y:t}}(e,a))}}),n.end&&r.a.createElement(j,{title:"End",x:n.end.x,y:n.end.y,onUpdate:function(e,a){return t(function(e,t){return{type:"SET_SELECTED_OBJECT_END",x:e,y:t}}(e,a))}}),a&&r.a.createElement("div",{className:"card bg-dark text-light border-secondary mb-3"},r.a.createElement("div",{className:"card-header border-secondary"},r.a.createElement("h5",null,"Actions")),r.a.createElement("div",{className:"card-body"},r.a.createElement("button",{className:"btn btn-outline-danger",onClick:function(){return t({type:"DELETE_OBJECT"})}},"Delete Object")))):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"card bg-dark text-light border-secondary mb-3"},r.a.createElement("div",{className:"card-header border-secondary"},r.a.createElement("h5",null,"Instructions")),r.a.createElement("div",{className:"card-body"},r.a.createElement("p",null,r.a.createElement("i",null,"Right click")," to pan the view."),r.a.createElement("p",null,r.a.createElement("i",null,"Scroll")," to zoom in and out."),r.a.createElement("p",null,r.a.createElement("i",null,"Left click and drag")," to create new spaces with the New Space tool."),r.a.createElement("p",null,r.a.createElement("i",null,"Left click")," to select spaces with the Select tool."),r.a.createElement("p",null,r.a.createElement("i",null,"Arrow keys")," will move the currently selected space."),r.a.createElement("p",null,r.a.createElement("i",null,"Delete")," will delete the currently selected space."))),r.a.createElement(T,{title:"Dungeon Size",width:c.width,height:c.height,onUpdate:function(e,a){return t(function(e,t){return{type:"SET_DUNGEON_SIZE",width:e,height:t}}(e,a))}}),r.a.createElement("div",{className:"card bg-dark text-light border-secondary mb-3"},r.a.createElement("div",{className:"card-header border-secondary"},r.a.createElement("h5",null,"Editor Options")),r.a.createElement("div",{className:"card-body"},r.a.createElement("div",null,r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",value:i,onChange:function(e){return t({type:"SET_SCROLL_MOVES_VIEWPORT",scrollMovesViewport:e.target.checked})}}),"Scroll to pan")))))},N=_=Object(S.b)((function(e){return{selectedObjectId:e.selectedObject,selectedObject:e.dungeon.spaces.filter((function(t){return t.id===e.selectedObject}))[0]||e.dungeon.walls.filter((function(t){return t.id===e.selectedObject}))[0],dungeonSize:e.dungeon.size,scrollPansViewport:e.scrollPansViewport}}))(_),D=function(e){var t=e.dispatch,a=e.selectedTool;return r.a.createElement("div",{className:"btn-group",role:"group"},r.a.createElement("button",{className:"btn btn-secondary"+("Select"===a?" active":""),onClick:function(){return t(p("Select"))}},"Select"),r.a.createElement("button",{className:"btn btn-secondary"+("NewSpace"===a?" active":""),onClick:function(){return t(p("NewSpace"))}},"New Space"),r.a.createElement("button",{className:"btn btn-secondary"+("NewWall"===a?" active":""),onClick:function(){return t(p("NewWall"))}},"New Wall"))},C=D=Object(S.b)((function(e){return{selectedTool:e.selectedTool}}))(D);var M=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("nav",{className:"navbar navbar-dark bg-secondary"},r.a.createElement("span",{className:"navbar-brand"},"Pungeon")),r.a.createElement("div",{className:"px-5"},r.a.createElement("div",{className:"py-2"},r.a.createElement(C,null)),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-9"},r.a.createElement(x,null)),r.a.createElement("div",{className:"col-md-3"},r.a.createElement(N,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(S.a,{store:v},r.a.createElement(M,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[26,1,2]]]);
//# sourceMappingURL=main.99855d40.chunk.js.map